#+title: Authorization
#+Author:GAbriel

* authorization in active directory
*access control lists (ACLs)*
- defines permissions on objects and resources

*security descriptors*
- contains ACLs

*security groups*
- primary method for assigning permissions efficiently

* verificando configs de um group
grupo domain admins de exemplo -->
#+begin_src powershell
Get-ADGroup -Identity "Domain Admins"
#+end_src

para pegar somente o distinguished name -->
#+begin_src powershell
$grp = (Get-ADGroup -Identity "Domain Admins").DistinguishedName
#+end_src

pegar o DACL do grupo selecionado -->
#+begin_src powershell
$acl = Get-Acl -Path "AD:\$groupDN"
#+end_src

- O DACL é a lista de ACEs (Access Control Entries).

*IdentityReference* -->
- o user ou grupo que possui a permissão (ex: BUILTIN\Administrators)

*ActiveDirectoryRights* -->
- o que eles podem fazer (ex: GenericRead, WriteProperty, ExtendedRight)

*AccessControlType* -->
- allow ou deny

Veriricando o owner do objeto atual -->
#+begin_src powershell
PS C:\Users\Administrator> $acl.Owner
DC01\Domain Admins
#+end_src

verificar diversos -->
#+begin_src powershell
$acl.Access
#+end_src

verificar a string SDDL (Security Descriptor Definition Language) -->
#+begin_src powershell
$acl.Sddl
#+end_src

* kerberos components
** key distribution Center (KDC)
- it is the core component of kerberos that deals with initial authentication and with the issuing of tickets

it is made up of two specific services -->

*Authentication Server (AS)*

  component that deals with initial authentication

  After verifying the user identity, it generates a *ticket granting ticket (TGT)*. these tickets can then be exchanged for *Service tickets*

*Ticket Granting Server (TGS)*

component responsible for issuing *service tickets* by using the TGT

** realm
- a kerberos realm defines a logical security boundary that contains group of principal (users, services and computers) that trust a specific *key distribution center (KDC)* for authencitacion purposes

  in active directory, a realm is automatically created when a domain is initialized. The kerberos realm is the uppercase version of the AD domain name

  for example, for the domain hexdump.lab, the kerberos realm will be HEXDUMP.LAB

to discover the realm your user is currently is, execute the following command, which print the User PRincipal Name (UPN)

#+begin_src powershell
whoami /upn
#+end_src

you can also use this other command

#+begin_src powershell
klist
#+end_src
